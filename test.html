<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ø®Ø§Ø¯Ù…</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 50px auto;
            padding: 20px;
            background: #f5f5f5;
        }
        .test-box {
            background: white;
            padding: 20px;
            border-radius: 10px;
            margin: 10px 0;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        .status {
            padding: 10px;
            border-radius: 5px;
            margin: 10px 0;
        }
        .success { background: #d4edda; color: #155724; }
        .error { background: #f8d7da; color: #721c24; }
        .warning { background: #fff3cd; color: #856404; }
        h1 { color: #333; }
        code {
            background: #f4f4f4;
            padding: 2px 6px;
            border-radius: 3px;
            font-family: monospace;
        }
    </style>
</head>
<body>
    <div class="test-box">
        <h1>ğŸ” Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ø®Ø§Ø¯Ù…</h1>
        <p>Ù‡Ø°Ù‡ Ø§Ù„ØµÙØ­Ø© Ù„Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø£Ù† Ø§Ù„Ø®Ø§Ø¯Ù… ÙŠØ¹Ù…Ù„ Ø¨Ø´ÙƒÙ„ ØµØ­ÙŠØ­</p>
    </div>

    <div class="test-box">
        <h2>1ï¸âƒ£ Ø§Ø®ØªØ¨Ø§Ø± Express</h2>
        <div id="test1" class="status warning">â³ Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±...</div>
        <p>Ø¥Ø°Ø§ Ø¸Ù‡Ø±Øª Ù‡Ø°Ù‡ Ø§Ù„ØµÙØ­Ø©ØŒ Express ÙŠØ¹Ù…Ù„! âœ…</p>
    </div>

    <div class="test-box">
        <h2>2ï¸âƒ£ Ø§Ø®ØªØ¨Ø§Ø± Socket.IO</h2>
        <div id="test2" class="status warning">â³ Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±...</div>
        <p>Ø§Ù„Ø­Ø§Ù„Ø©: <span id="socket-status">ØºÙŠØ± Ù…ØªØµÙ„</span></p>
    </div>

    <div class="test-box">
        <h2>3ï¸âƒ£ Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ù†Ø·Ø§Ù‚</h2>
        <p><strong>Ø§Ù„Ø±Ø§Ø¨Ø·:</strong> <code id="url"></code></p>
        <p><strong>Ø§Ù„Ø¨Ø±ÙˆØªÙˆÙƒÙˆÙ„:</strong> <code id="protocol"></code></p>
        <p><strong>Ø§Ù„Ù…Ù†ÙØ°:</strong> <code id="port"></code></p>
    </div>

    <div class="test-box">
        <h2>ğŸ“‹ Ø§Ù„Ø³Ø¬Ù„</h2>
        <div id="log" style="background: #f4f4f4; padding: 10px; border-radius: 5px; max-height: 200px; overflow-y: auto;"></div>
    </div>

    <script src="/socket.io/socket.io.js"></script>
    <script>
        // Ø¹Ø±Ø¶ Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ù†Ø·Ø§Ù‚
        document.getElementById('url').textContent = window.location.href;
        document.getElementById('protocol').textContent = window.location.protocol;
        document.getElementById('port').textContent = window.location.port || 'Ø§ÙØªØ±Ø§Ø¶ÙŠ';

        // ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø±Ø³Ø§Ø¦Ù„
        function log(message, type = 'info') {
            const logDiv = document.getElementById('log');
            const time = new Date().toLocaleTimeString('ar-SA');
            logDiv.innerHTML += `<div>[${time}] ${message}</div>`;
            logDiv.scrollTop = logDiv.scrollHeight;
        }

        // Ø§Ø®ØªØ¨Ø§Ø± 1: Express
        document.getElementById('test1').className = 'status success';
        document.getElementById('test1').textContent = 'âœ… Express ÙŠØ¹Ù…Ù„ Ø¨Ù†Ø¬Ø§Ø­!';
        log('âœ… Express ÙŠØ¹Ù…Ù„ - Ø§Ù„ØµÙØ­Ø© ØªÙ… ØªØ­Ù…ÙŠÙ„Ù‡Ø§', 'success');

        // Ø§Ø®ØªØ¨Ø§Ø± 2: Socket.IO
        try {
            log('ğŸ”Œ Ù…Ø­Ø§ÙˆÙ„Ø© Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ù€ Socket.IO...');
            
            const socket = io({
                transports: ['websocket', 'polling']
            });

            socket.on('connect', () => {
                document.getElementById('test2').className = 'status success';
                document.getElementById('test2').textContent = 'âœ… Socket.IO ÙŠØ¹Ù…Ù„ Ø¨Ù†Ø¬Ø§Ø­!';
                document.getElementById('socket-status').textContent = 'Ù…ØªØµÙ„ âœ…';
                document.getElementById('socket-status').style.color = 'green';
                log('âœ… Socket.IO Ù…ØªØµÙ„ - ID: ' + socket.id, 'success');
            });

            socket.on('connect_error', (error) => {
                document.getElementById('test2').className = 'status error';
                document.getElementById('test2').textContent = 'âŒ ÙØ´Ù„ Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ù€ Socket.IO';
                document.getElementById('socket-status').textContent = 'ØºÙŠØ± Ù…ØªØµÙ„ âŒ';
                document.getElementById('socket-status').style.color = 'red';
                log('âŒ Ø®Ø·Ø£ ÙÙŠ Socket.IO: ' + error.message, 'error');
            });

            socket.on('disconnect', () => {
                document.getElementById('socket-status').textContent = 'Ù‚Ø·Ø¹ Ø§Ù„Ø§ØªØµØ§Ù„';
                document.getElementById('socket-status').style.color = 'orange';
                log('âš ï¸ ØªÙ… Ù‚Ø·Ø¹ Ø§Ù„Ø§ØªØµØ§Ù„', 'warning');
            });

        } catch (error) {
            document.getElementById('test2').className = 'status error';
            document.getElementById('test2').textContent = 'âŒ Socket.IO ØºÙŠØ± Ù…Ø­Ù…Ù‘Ù„!';
            log('âŒ Ø®Ø·Ø£: io ØºÙŠØ± Ù…Ø¹Ø±Ù‘Ù - ØªØ­Ù‚Ù‚ Ù…Ù† ØªØ­Ù…ÙŠÙ„ socket.io.js', 'error');
        }

        // Ø§Ø®ØªØ¨Ø§Ø± ØªØ­Ù…ÙŠÙ„ socket.io.js
        window.addEventListener('load', () => {
            if (typeof io === 'undefined') {
                log('âŒ Ù…ÙƒØªØ¨Ø© Socket.IO ØºÙŠØ± Ù…Ø­Ù…Ù‘Ù„Ø©! ØªØ£ÙƒØ¯ Ù…Ù† Ø£Ù† Ø§Ù„Ø®Ø§Ø¯Ù… ÙŠØ¹Ù…Ù„.', 'error');
            } else {
                log('âœ… Ù…ÙƒØªØ¨Ø© Socket.IO Ù…Ø­Ù…Ù‘Ù„Ø© Ø¨Ù†Ø¬Ø§Ø­', 'success');
            }
        });
    </script>
</body>
</html>

